# Ğ“Ğ Ğ£ĞŸĞŸĞ: Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (EVENTS)
# ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: Ğ¡Ğ»Ğ¾Ğ²Ğ°Ñ€ÑŒ Ñ ÑÑĞ¶ĞµÑ‚Ğ½Ñ‹Ğ¼Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼Ğ¸ (Ñ‚ĞµĞºÑÑ‚, Ğ²Ñ‹Ğ±Ğ¾Ñ€Ñ‹, ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹, Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹). Ğ­Ñ‚Ğ¾ Ğ±Ğ°Ğ·Ğ° Ğ´Ğ»Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸, Ğ»ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ 20+.

# Ğ‘Ğ›ĞĞš 1.1: EVENTS dict
# ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (wolf, cat Ğ¸ Ñ‚.Ğ´.). ĞÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¸ Ğ¸ÑÑ…Ğ¾Ğ´Ğ¾Ğ².
EVENTS = {
    'wolf': {
        'text': "Ğ’Ñ‹ Ğ²ÑÑ‚Ñ€ĞµÑ‚Ğ¸Ğ»Ğ¸ Ğ²Ğ¾Ğ»ĞºĞ°!",
        'kb_name': 'wolf_kb',  # â† ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
        'effects': {
            'wolf_flee': {'hp': -10, 'karma': -5},
            'wolf_fight': {'hp': -20, 'karma': +10}
        },
        'outcomes': {
            'wolf_flee': "Ğ’Ñ‹ ÑƒĞ±ĞµĞ¶Ğ°Ğ»Ğ¸ Ğ¾Ñ‚ Ğ²Ğ¾Ğ»ĞºĞ°, Ğ½Ğ¾ Ğ¿Ğ¾Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸ÑÑŒ.",
            'wolf_fight': "Ğ’Ñ‹ ÑÑ€Ğ°Ğ·Ğ¸Ğ»Ğ¸ÑÑŒ Ñ Ğ²Ğ¾Ğ»ĞºĞ¾Ğ¼ Ğ¸ Ğ¿Ğ¾Ğ±ĞµĞ´Ğ¸Ğ»Ğ¸."
        },
        'trigger': {'day': 2, 'ap': 3, 'counters': {'berries': 2}}  # ÑƒĞ±Ñ€Ğ°Ğ» randint, ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ â€” Ğ¾ÑÑ‚Ğ°Ğ²ÑŒ
    },
    'cat': {
        'text': "Ğ’Ñ‹ Ğ½Ğ°ÑˆĞ»Ğ¸ ĞºĞ¾Ñ‚Ğ°!",
        'kb_name': 'cat_kb',
        # ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ
    },
    'peek_den': {
        'text': "Ğ’Ñ‹ Ğ·Ğ°Ğ³Ğ»ÑĞ½ÑƒĞ»Ğ¸ Ğ² Ğ½Ğ¾Ñ€Ñƒ...",
        'kb_name': 'peek_den_kb',
        # ...
    },
    # Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ 20+ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹: {'event20': {'text': '...', 'trigger': {'day':10}}}
}

# Ğ“Ğ Ğ£ĞŸĞŸĞ: Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ¸ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²
# ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ñ‹ÑĞ»ĞµĞ¹, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹ Ğ´Ğ»Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹. ĞÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ÑÑĞ¶ĞµÑ‚Ğ°.

# Ğ‘Ğ›ĞĞš 2.1: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ (get_thought)
# ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: Ğ¡Ğ»Ğ¾Ğ²Ğ°Ñ€ÑŒ Ğ¼Ñ‹ÑĞ»ĞµĞ¹ Ğ¿Ğ¾ ĞºĞ»ÑÑ‡Ñƒ. ĞÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·Ğ¾Ğº Ğ² Ğ»Ğ¾Ğ³Ğ°Ñ… (Ñ‚Ğ¸Ğ¿Ğ° Ğ¾ Ñ„Ğ°ĞºĞµĞ»Ğµ).
def get_thought(key):
    thoughts = {
        'branch_found': "ğŸ¤” ĞœÑ‹ÑĞ»ÑŒ: Ğ Ğ¸Ğ· ÑÑ‚Ğ¾Ğ¹ Ğ²ĞµÑ‚ĞºĞ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ñ„Ğ°ĞºĞµĞ»?",
        # Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ: 'berries_eaten': "ĞœÑ‹ÑĞ»ÑŒ: ĞŸĞµÑ€ĞµĞµĞ»?"
    }
    return thoughts.get(key, "")

# Ğ‘Ğ›ĞĞš 2.2: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ (trigger_event)
# ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ: Ğ¦Ğ¸ĞºĞ» Ğ¿Ğ¾ EVENTS, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹ (day, ap, counters). Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¸Ğ¼Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚. ĞÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° ÑÑĞ¶ĞµÑ‚Ğ° Ğ¿Ğ¾ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ°Ğ¼.
def trigger_event(game):
    for event_name, event in EVENTS.items():
        trig = event.get('trigger', {})
        if (trig.get('day') == game.day and
            trig.get('ap') == game.ap and
            all(game.resource_counters.get(k, 0) >= v for k, v in trig.get('counters', {}).items())):
            return event_name
    return None
